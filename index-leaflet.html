<!DOCTYPE html>
<html>
  <head>
    <title>// homely \\</title>
    <meta charset="utf-8">
    <!-- JQuery -->
    <script src="jquery.js"></script>
   
    <!-- Leaflet -->
    <script>L_PREFER_CANVAS = true;</script>
    <link rel="stylesheet" href="style-leaflet.css" type="text/css">
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
    <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>

    <script src="leaflet.ajax.js"></script>

    <!-- JQuery UI -->


<!-- <link href=
    "http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" rel=
    "stylesheet">
   // <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script> -->


<link href=
    "http://code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css" rel=
    "stylesheet">
   <script src="http://code.jquery.com/ui/1.11.0/jquery-ui.js"></script>

  </head>



  <body>

      <!-- Add map using leaflet -->
      <div id="map" class="map"></div>


      <!-- HEADER -->
  <div id="header" class="header">

        <span> <img src="homely-icon.jpg" height="26px"/></span>


        <span id="homely">HOMELY</span>

<!--           <span class="dropdown">
            <button class="dropbtn">Export</button>
            <div class="dropdown-content">
                <a href="#">HTML</a>
                <a href="#">CSV</a>
                <a href="#">GEOJSON</a>
            </div>
          </span> -->

          <button class="nav" onclick="openNav()">Filter</button>

  </div>

          <div id="mySidenav" class="sidenav">
            <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&#215</a>
            <span class="filtertype">Property Type: </span><br>
            <input type="checkbox" value="None" id="houseCB" checked="true" />House
            <input type="checkbox" value="None" id="apartmentCB" checked="true" />Apartment
            <input type="checkbox" value="None" id="townhouseCB" checked="true" />Townhouse

            <p>
            <span class="filtertype">Property Type: </span><br>
            <input type="checkbox" value="None" id="houseCB" checked="true" />House
            <input type="checkbox" value="None" id="apartmentCB" checked="true" />Apartment
            <input type="checkbox" value="None" id="townhouseCB" checked="true" />Townhouse

            <p>
            <span class="filtertype">EER: </span><input type="text" id="EERvalue" readonly style="border:0; color:#f6931f; font-weight:bold;"><br>
            <div id="EERslider"></div> 
            <p><p>
            <button class="updatebtn" onclick="updateLayers()">Update</button>



        </div>



<script>

  $(function() {
    $( "#EERslider" ).slider({
      range: true,
      min: 0,
      max: 10,
      step: 1,
      values: [ 2, 8 ],
      slide: function( event, ui ) {
        $( "#EERvalue" ).val( ui.values[ 0 ] + " - " + ui.values[ 1 ] );
      }
    });
    $( "#EERvalue" ).val($( "#EERslider" ).slider( "values", 0 ) +
      " - " + $( "#EERslider" ).slider( "values", 1 ) );
  });

function openNav() {
    document.getElementById("mySidenav").style.display = "block";
}

function closeNav() {
    document.getElementById("mySidenav").style.display = "none";
}

var map = L.map('map',{zoomControl:false}); // what does this do?


//add zoom control with your options
L.control.zoom({
     position:'bottomleft'
}).addTo(map);
var osmUrl='http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
  var osmAttrib='Map data Â© <a href="http://openstreetmap.org">OpenStreetMap</a> contributors';
  var osm = new L.TileLayer(osmUrl); //, {attribution: osmAttrib});   

  map.setView([-35.26162,149.145187],12); // start the map in Canberra, Australia
  map.addLayer(osm); // add OSM layer to map


 // icons for markers
var houseIconOrange = L.icon({
    iconUrl: 'house-icon-orange.png',
    iconSize:     [25, 27], // size of the icon
    iconAnchor:   [12, 27], // point of the icon which will correspond to marker's location
    popupAnchor:  [1, -35] // point from which the popup should open relative to the iconAnchor
});

var houseIconRed = L.icon({
    iconUrl: 'house-icon-red.png',
    iconSize:     [25, 27], // size of the icon
    iconAnchor:   [12, 27], // point of the icon which will correspond to marker's location
    popupAnchor:  [1, -35] // point from which the popup should open relative to the iconAnchor
});

var busstopIcon = L.icon({
    iconUrl: 'busstop-icon.png',
    iconSize:     [20, 20], // size of the icon
    iconAnchor:   [10, 20], // point of the icon which will correspond to marker's location
    popupAnchor:  [1, -35] // point from which the popup should open relative to the iconAnchor
});

function propertyPopup(feature, layer) {
  layer.bindPopup("<b>" + feature.properties.name + "</b><br>" + feature.properties.price);
}
 
function busstopPopup(feature, layer) {
  layer.bindPopup("<b>" + feature.properties.name + "</b>");
}

// var addressLayer = $.getJSON("addresses.geojson");


// addressLayer.then(function(data) {

        
//         var allAddresses = L.geoJson(data);

//         // THIS IS NEW
//         var house = L.geoJson(data, {
//             filter: function(feature, layer) {
//                 return feature.properties.propertytype == "House";
//             },
//             pointToLayer: function(feature, latlng) {
//                 return L.marker(latlng, {
//                     icon: houseIconOrange
//                 })
//             },
//             onEachFeature: onEachFeature
//         });


//         var others = L.geoJson(data, {
//             filter: function(feature, layer) {
//                 return feature.properties.propertytype != "House";
//             },
//             pointToLayer: function(feature, latlng) {
//                 return L.marker(latlng, {
//                     icon: houseIconRed
//                 })
//             },
//             onEachFeature: propertyPopup
//         });
       
//         map.fitBounds(allAddresses.getBounds(), {
//             padding: [50, 50]
//         });

//         // THIS IS NEW
//         house.addTo(map)
//         others.addTo(map)
//     });

// var busstopLayer = $.getJSON("data/busstops.geojson");
// console.log(busstopLayer);

// busstopLayer.then(function(data) {

        
//         var allBusstops = L.geoJson(data);

//         // THIS IS NEW
//         var busstops = L.geoJson(data, {
//             filter: function(feature, layer) {
//                 return feature.properties.amenity == "bus stop";
//             },
//             pointToLayer: function(feature, latlng) {
//                 return L.marker(latlng, {
//                     icon: busstopIcon
//                 })
//             }//,
//             //onEachFeature: busstopPopup
//         });


       
//         map.fitBounds(allBusstops.getBounds(), {
//             padding: [50, 50]
//         });

//         // THIS IS NEW

//         // busstops.addTo(map);
        

//     });

var busstopPoints = L.geoJson.ajax("data/busstops.geojson",{
              pointToLayer: function(feature, latlng) {
                return L.marker(latlng, {
                    icon: busstopIcon
                })
              },
              onEachFeature: busstopPopup
}); //.addTo(map); // Adding the entire geoJson layer to the map.


map.on("zoomend", function () {
    if (map.getZoom() >= 15) {
        map.addLayer(busstopPoints);
    } else {
        // Removing entire geoJson layer that contains the points.
        map.removeLayer(busstopPoints);
    }
});

// function updateLayers() {
//     //console.log(document.getElementById('houseCB').checked);

//     map.eachLayer(function (layer) {
//       map.removeLayer(layer);
//     });


//     geojsonLayer.then(function(data) {

        
//         var allbusinesses = L.geoJson(data);

//         // THIS IS NEW
        
//           var house = L.geoJson(data, {
//               filter: function(feature, layer) {
//                   return feature.properties.propertytype == "House";
//               },
//               pointToLayer: function(feature, latlng) {
//                   return L.marker(latlng, {
//                       icon: houseIconOrange
//                   })
//               },
//               onEachFeature: onEachFeature
//           });




//         var apartment = L.geoJson(data, {
//             filter: function(feature, layer) {
//                 return feature.properties.propertytype == "Apartment";
//             },
//             pointToLayer: function(feature, latlng) {
//                 return L.marker(latlng, {
//                     icon: houseIconRed
//                 })
//             },
//             onEachFeature: onEachFeature
//         });

//         var townhouse = L.geoJson(data, {
//             filter: function(feature, layer) {
//                 return feature.properties.propertytype == "Townhouse";
//             },
//             pointToLayer: function(feature, latlng) {
//                 return L.marker(latlng, {
//                     icon: houseIconRed
//                 })
//             },
//             onEachFeature: onEachFeature
//         });
       
//         map.fitBounds(allbusinesses.getBounds(), {
//             padding: [50, 50]
//         });


//         if (document.getElementById('houseCB').checked == true) {
//           house.addTo(map)
//         }
//         if (document.getElementById('apartmentCB').checked == true) {
//           apartment.addTo(map)
//         }
//         if (document.getElementById('townhouseCB').checked == true) {
//           townhouse.addTo(map)
//         }
//         map.addLayer(osm);
//     });

// }


</script>




  </body>
</html>






